<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>æ¬¢è¿ - Leoçš„ä¸ªäººç½‘ç«™</title>
		<style>
			:root{/*å®šä¹‰å˜é‡*/
				--a:1;
			}
			html,body{
				margin: 0;
				padding: 0;
				width: 100%;
				height: 100%;
			}
			body{
				background-color: black;
			}
			*{
				color: white;
			}
			.pages{
				width: 100%;
				height: 100%;
				opacity: 1;
			}
			.center{
				display: flex;
				align-items: center;
				justify-content: center;
			}

			#welcome{
				text-align: center;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}
			#user_pic{
				margin-bottom: 8vh;
				
			}
			#welcome button{
				border: 1px white solid;
				background-color: transparent;
				padding: 5px 10px 5px 10px;
				font-size: 150%;
			}
			#welcome button:hover{
				background-color: gray;
			}

			#menu header{
				background-color: dimgray;
				display: flex; /* ä½¿ç”¨ flexbox å¸ƒå±€ */
				justify-content: space-between; /* ä½¿å­å…ƒç´ åˆ†åˆ«ä½äºå®¹å™¨çš„ä¸¤ç«¯ */
				align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½å­å…ƒç´  */
			}
			#menu header #right-content{
				display: flex; /* ä½¿ç”¨ flexbox å¸ƒå±€ */
				align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½å­å…ƒç´  */
				white-space: nowrap; /* é˜²æ­¢æ–‡æœ¬æ¢è¡Œ */;
			}
			#menu header p{
				margin: 0;
				padding: 5px 0px 5px 15px;
				font-size: 100%;
			}
			#menu header #datetime{
				margin-right: 5%;
				padding: 0px 15px 0px 15px;
				font-size: 100%;
			}
			#menu header #weather{
				padding: 0px 5px 0px 5px;
				font-size: 100%;
			}
			#menu header #weather,#menu header #datetime {
				/* é˜²æ­¢è‡ªèº«æ–‡å­—æ¢è¡Œ */
				white-space: nowrap; 
				/* é˜²æ­¢å†…å®¹æº¢å‡ºæ—¶è¢«æˆªæ–­ */
				overflow: visible; 
				/* æ–‡æœ¬æº¢å‡ºæ—¶æ˜¾ç¤ºçœç•¥å·ï¼Œå¯æ ¹æ®éœ€æ±‚é€‰æ‹©æ˜¯å¦æ·»åŠ  */
				/* text-overflow: ellipsis;  */
			}

			/* #menu header button{
			} */

			.folder {
				display: inline-block;
				margin: 5%;
				text-align: center;
				cursor: pointer;
			}

			.folder-icon {
				font-size: 10vh;
			}

			.folder-name {
				font-size: 80%;
			}
			#menu {
				display: flex;
				flex-direction: column;
				height: 100%; /* ç¡®ä¿ #menu å æ®å¯ç”¨é«˜åº¦ */
			}
			#menu header {
				/* ä¿æŒåŸæœ‰çš„æ ·å¼ï¼Œç¡®ä¿ header æ­£å¸¸æ˜¾ç¤º */
				background-color: dimgray;
				display: flex; 
				justify-content: space-between; 
				align-items: center; 
				/* å›ºå®š header çš„é«˜åº¦ï¼Œé˜²æ­¢è¢« flex å¸ƒå±€å½±å“ */
				flex-shrink: 0; 
			}
			#menu #menu-content {
				width: 75%; /* ç¡®ä¿ #menu-content å®½åº¦ä¸è¶…è¿‡çˆ¶å®¹å™¨å®½åº¦ */;
				
				align-items: center;
				background-color: gray;
				/* è®© #menu-content è‡ªåŠ¨å¡«å……å‰©ä½™ç©ºé—´ */
				flex-grow: 1; 
				margin: auto;
				text-align: center;
			}

			#cover {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.5); /* åŠé€æ˜é»‘è‰² */
				z-index: 999; /* ç¡®ä¿è¦†ç›–å±‚åœ¨å…¶ä»–å†…å®¹ä¹‹ä¸Š */
				display: none; /* é»˜è®¤éšè— */
			}

			#tools {
				display: none;

				padding: 20px;
				background-color: gray;
				margin: 0 auto;
				width: 75%;
				height: calc(100% - 40px);
				overflow-y: auto;
			}

			#tools h3 {
				font-size: 1.2em;
				background-color: dimgray;
				padding: 5px 15px;
				margin: 20px 0 10px;
			}

			#tools a {
				display: block;
				padding: 10px 15px;
				text-decoration: none;
				cursor: pointer;
				text-align: center;
			}

			#tools a:hover {
				background-color: rgba(255, 255, 255, 0.1);
			}

		</style>
	</head>
	<body>
		<div class="pages center" id="welcome">
			<div id="user_pic">
				<svg t="1743416333274" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2617" width="150" height="150"><path d="M515.541449 7.082899c-280.359429 0-508.458551 228.120391-508.458551 508.458551s228.120391 508.458551 508.458551 508.458551 508.458551-228.120391 508.458551-508.458551S795.900879 7.082899 515.541449 7.082899zM515.541449 981.864196c-257.132626 0-466.301477-209.190121-466.301477-466.322747 0-257.132626 209.168851-466.322747 466.301477-466.322747s466.301477 209.190121 466.301477 466.322747S772.674075 981.864196 515.541449 981.864196zM614.574414 524.177056 614.574414 524.177056c47.751075-31.96876 79.230625-86.398604 79.230625-148.187857 0-98.437405-79.804915-178.24232-178.24232-178.24232-98.437405 0-178.24232 79.804915-178.24232 178.24232 0 61.810523 31.479551 116.219097 79.251895 148.187857-100.266622 39.519598-171.244501 137.170014-171.244501 251.453545 0 0.23397 0 0.446669 0.02127 0.659369 0 0.04254-0.02127 0.10635-0.02127 0.14889 0 15.612155 12.65563 28.246516 28.267786 28.246516 15.590885 0 21.886796-12.63436 21.886796-28.246516 0-0.340319-0.08508-0.659369-0.10635-1.020958 0.10635-118.005774 102.159649-219.995264 220.207964-219.995264 118.112124 0 220.207964 102.095839 220.207964 220.207964 0 0.14889-1.467628 29.054774 21.971875 29.054774 15.505806 0 28.076356-12.57055 28.076356-28.055086 0-0.06381-0.02127-0.12762-0.02127-0.2127 0-0.25524 0.02127-0.510479 0.02127-0.786989C785.797645 661.34707 714.798496 563.696654 614.574414 524.177056zM515.541449 510.734437c-74.402343 0-134.723968-60.321625-134.723968-134.723968 0-74.423613 60.321625-134.723968 134.723968-134.723968 74.423613 0 134.723968 60.321625 134.723968 134.723968S589.943792 510.734437 515.541449 510.734437z" fill="#e6e6e6" p-id="2618"></path></svg>
			</div>
			<button onclick="tab(welcome,menu)">æ¬¢è¿ - è¿›å…¥ç½‘é¡µ</button>
			<p>ä½ å¥½ï¼Œæˆ‘æ˜¯LeoSuï¼Œ<br>
				æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººç½‘ç«™ï¼Œ<br>åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥æ‰¾åˆ°æˆ‘åˆ†äº«çš„å„ç§èµ„æºï¼ŒåŒ…æ‹¬å·¥å…·ã€ç²¾ç¾ç…§ç‰‡ç­‰ã€‚</p>
		</div>
		<div class="pages" id="menu">
			<header>
				<p>Leo<b>S</b>uçš„ä¸ªäººç½‘ç«™</p>
				<button onclick="back()">è¿”å›</button>
				<div id="right-content">
					<div id="weather">ç¤ºä¾‹</div>
					<div id="datetime"></div>
				</div>
			</header>
			<div id="menu-content">
				<div class="folder" onclick="tab(menu_content,tools)">
					<div class="folder-icon">ğŸ“</div>
					<div class="folder-name">å·¥å…·</div>
				</div>
				<div class="folder" onclick="tab(menu_content,tools_link)">
					<div class="folder-icon">ğŸ“</div>
					<div class="folder-name">ç«™å¤–å·¥å…·</div>
				</div>
				<div class="folder">
					<div class="folder-icon">ğŸ“</div>
					<div class="folder-name">ç²¾ç¾ç…§ç‰‡</div>
				</div>
				<div class="folder">
					<div class="folder-icon">ğŸ“</div>
					<div class="folder-name">æˆ‘çš„æ–‡ä»¶å¤¹</div>
				</div>
				<div class="folder">
					<div class="folder-icon">ğŸ“</div>
					<div class="folder-name">æˆ‘çš„æ–‡ä»¶å¤¹</div>
				</div>
			</div>
			<div class="page tools" id="tools"></div>
			<div class="page tools" id="tools-link">
				<input type="text" id="search-input" placeholder="æœç´¢ç½‘ç«™åç§°">
				<select id="category-select">
					<option value="">å…¨éƒ¨åˆ†ç±»</option>
				</select>
			</div>
		</div>
		
		<!-- <div class="pages floder-content" id="cover"></div> -->
	</body>
	<script>// å®šä¹‰å˜é‡
		// var page_css = []
		// for (var i=0;i<document.getElementsByClassName("pages").length;i++){
		// 	page_css.push(window.getComputedStyle(document.getElementsByClassName("pages")[i]))
		// } 
		var now_page
		var welcome = document.getElementById("welcome");
		var menu = document.getElementById("menu");
		var menu_content = document.getElementById("menu-content");
		var tools = document.getElementById("tools");
		var tools_link = document.getElementById("tools-link");
	</script>
	<script src="./js/time.js"></script><!--æ—¶é—´-->
	<script>// å‡½æ•°
		function getQueryParams() {// è·å–URLå‚æ•°
			const params = new URLSearchParams(window.location.search);
			return Object.fromEntries(params.entries());
		}
		function getCssValue(element,css){// è·å–å…ƒç´ çš„csså±æ€§å€¼
			return window.getComputedStyle(element).getPropertyValue(css)	
		}
		function tab(page,change){// åˆ‡æ¢é¡µé¢
			page.style.display = "none";
			// change.style.display = getCssValue(change,"display");
			if (change==menu){
				change.style.display = "flex"
			} else if (change==tools){
				change.style.display = "block"
			} else if (change==tools_link){
				change.style.display = "block"
			} else if (change==welcome){
				change.style.display = "flex"
			} else if (change==menu_content){
				change.style.display = "block"
			}
			now_page = change.id;
		}
		function back(){// è¿”å›ä¸Šä¸€é¡µ
			if (now_page=='menu' || now_page=='menu-content'){
				tab(menu,welcome)
			} else if (now_page=='tools'){
				tab(tools,menu_content)	
			} else if (now_page=='tools-link'){
				tab(tools_link,menu_content)	
			}
		}
			// å®šä¹‰ç”Ÿæˆå·¥å…·åˆ—è¡¨çš„å‡½æ•°
		function generateToolList(container, list) {
			if (customCategories) {
				customCategories.forEach(category => {
					const categoryHeader = document.createElement('h3');
					categoryHeader.textContent = category.name;
					container.appendChild(categoryHeader);

					const categoryTools = list.filter(tool => category.tools.includes(tool.name));
					categoryTools.forEach(tool => {
						const toolLink = document.createElement('a');
						toolLink.textContent = tool.name;
						container.appendChild(toolLink);
					});
				});
			} else {
				// æŒ‰æ‹¼éŸ³æ’åº
				const sortedToolList = [...list].sort((a, b) => a.name.localeCompare(b.name, 'zh-CN'));

				// åˆ›å»ºæŒ‰æ‹¼éŸ³åˆ†ç±»çš„åˆ—è¡¨
				let currentLetter = '';
				sortedToolList.forEach(tool => {
					const firstLetter = tool.name.charAt(0).toLocaleUpperCase('zh-CN');
					if (firstLetter !== currentLetter) {
						currentLetter = firstLetter;
						const letterHeader = document.createElement('h3');
						letterHeader.textContent = currentLetter;
						container.appendChild(letterHeader);
					}
					const toolLink = document.createElement('a');
					toolLink.textContent = tool.name;
					container.appendChild(toolLink);
				});
			}
		}

		// å®šä¹‰ç”Ÿæˆå·¥å…·é“¾æ¥åˆ—è¡¨çš„å‡½æ•°
		async function generateToolLinkList(container) {
			try {
				// è¯»å– XLSX æ–‡ä»¶
				const response = await fetch('./tool_links.xlsx');
				const arrayBuffer = await response.arrayBuffer();
				const data = new Uint8Array(arrayBuffer);
				const workbook = XLSX.read(data, { type: 'array' });
				const sheetName = workbook.SheetNames[0];
				const worksheet = workbook.Sheets[sheetName];
				const jsonData = XLSX.utils.sheet_to_json(worksheet);

				// è·å–åˆ†ç±»é€‰é¡¹
				const categories = [...new Set(jsonData.map(item => item['Båˆ—']))];
				const categorySelect = document.getElementById('category-select');
				categories.forEach(category => {
					const option = document.createElement('option');
					option.value = category;
					option.textContent = category;
					categorySelect.appendChild(option);
				});

				// æ¸²æŸ“åˆå§‹åˆ—è¡¨
				renderToolLinks(jsonData, container);

				// æ·»åŠ æœç´¢å’Œç­›é€‰äº‹ä»¶ç›‘å¬
				const searchInput = document.getElementById('search-input');
				if (searchInput && categorySelect) {
					searchInput.addEventListener('input', () => filterToolLinks(jsonData, container));
					categorySelect.addEventListener('change', () => filterToolLinks(jsonData, container));
				}
			} catch (error) {
				console.error('è¯»å– XLSX æ–‡ä»¶å‡ºé”™:', error);
			}
		}
		// æ¸²æŸ“å·¥å…·é“¾æ¥åˆ—è¡¨
		function renderToolLinks(data, container) {
			container.innerHTML = '';
			const groupedData = groupByCategory(data);
			Object.entries(groupedData).forEach(([category, items]) => {
				const categoryHeader = document.createElement('h3');
				categoryHeader.textContent = category;
				container.appendChild(categoryHeader);

				items.forEach(item => {
					const toolLink = document.createElement('a');
					toolLink.textContent = item['Aåˆ—'];
					toolLink.href = item['Fåˆ—'];
					toolLink.target = '_blank';
					toolLink.title = `ç®€ä»‹: ${item['Dåˆ—']} | æ˜¯å¦éœ€è¦åŠ é€Ÿå™¨: ${item['Cåˆ—'] === 'T' ? 'éœ€è¦' : 'ä¸éœ€è¦'}`;
					container.appendChild(toolLink);
				});
			});
		}

		// æŒ‰åˆ†ç±»åˆ†ç»„æ•°æ®
		function groupByCategory(data) {
			return data.reduce((acc, item) => {
				if (!acc[item['Båˆ—']]) {
					acc[item['Båˆ—']] = [];
				}
				acc[item['Båˆ—']].push(item);
				return acc;
			}, {});
		}

		// è¿‡æ»¤å·¥å…·é“¾æ¥
		function filterToolLinks(data, container) {
			const searchInput = document.getElementById('search-input').value.toLowerCase();
			const selectedCategory = document.getElementById('category-select').value;

			let filteredData = data;
			if (selectedCategory) {
				filteredData = filteredData.filter(item => item['Båˆ—'] === selectedCategory);
			}
			if (searchInput) {
				filteredData = filteredData.filter(item => item['Aåˆ—'].toLowerCase().includes(searchInput));
			}

			renderToolLinks(filteredData, container);
		}

		// ç¡®ä¿ DOM åŠ è½½å®Œæˆåå†æ‰§è¡Œä»£ç 
		document.addEventListener('DOMContentLoaded', function() {
			// ç”Ÿæˆ tools-link é¡µé¢å†…å®¹
			const tools_link = document.getElementById('tools-link');
			if (tools_link) {
				generateToolLinkList(tools_link);
			}
		});
	</script>
	<script>// é¡µé¢åŠ è½½ï¼ˆæµ‹è¯•ç”¨ï¼‰
		tab(welcome,menu);
		tab(menu_content,tools_link);
	</script>
	<script>// å·¥å…·é¡µé¢
			// å®šä¹‰ tools é¡µé¢çš„å·¥å…·åˆ—è¡¨
		const toolList = [
			{ name: 'é—¹é’Ÿ' },
			{ name: 'æ—¥å†' },
			{ name: 'è®¡æ—¶å™¨' },
			{ name: 'ç§’è¡¨' }
		];

		// ç”Ÿæˆ tools é¡µé¢å†…å®¹
		generateToolList(tools, toolList,customCategories = null);
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
	<script>// å·¥å…·é“¾æ¥é¡µ
		// ç”Ÿæˆ tools-link é¡µé¢å†…å®¹
    	generateToolLinkList(tools_link);
	</script>
</html>